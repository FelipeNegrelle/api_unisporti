ALTER TABLE training
DROP
CONSTRAINT fk57u5lguse6c7nqwn93dkolg57;

ALTER TABLE presence
DROP
CONSTRAINT fkeqrsdpetuj3d3ixiv84j04wj5;

ALTER TABLE modality
DROP
CONSTRAINT fki8bafwkanqsb830i4qv4y5j1g;

ALTER TABLE training_user
DROP
CONSTRAINT fkn4joa4vo5xc9h1mcg4ind1vmp;

ALTER TABLE training_user
DROP
CONSTRAINT fkobocx35f90d5ys3pw5vcrfn87;

ALTER TABLE training
DROP
CONSTRAINT fkqd4uev8s17yl727sod7r3825p;

ALTER TABLE presence
DROP
CONSTRAINT fkqtni0agis6muclsicefca8r2x;

ALTER TABLE users
    ADD CONSTRAINT uc_users_id_role UNIQUE (id_role);

DROP TABLE images CASCADE;

DROP TABLE instructor CASCADE;

DROP TABLE modality CASCADE;

DROP TABLE poll CASCADE;

DROP TABLE poll_response CASCADE;

DROP TABLE presence CASCADE;

DROP TABLE question CASCADE;

DROP TABLE question_response CASCADE;

DROP TABLE question_type CASCADE;

DROP TABLE service CASCADE;

DROP TABLE training CASCADE;

DROP TABLE training_user CASCADE;

ALTER TABLE users
ALTER
COLUMN email TYPE VARCHAR(255) USING (email::VARCHAR(255));

ALTER TABLE users
ALTER
COLUMN first_name TYPE VARCHAR(255) USING (first_name::VARCHAR(255));

ALTER TABLE place
DROP
COLUMN id_place;

ALTER TABLE place
DROP
COLUMN max_capacity;

ALTER TABLE place
    ADD id_place BIGINT NOT NULL PRIMARY KEY;

ALTER TABLE role
DROP
COLUMN id_role;

ALTER TABLE role
    ADD id_role BIGINT NOT NULL PRIMARY KEY;

ALTER TABLE users
DROP
COLUMN id_role;

ALTER TABLE users
DROP
COLUMN id_user;

ALTER TABLE users
    ADD id_role BIGINT;

ALTER TABLE users
    ADD CONSTRAINT uc_users_id_role UNIQUE (id_role);

ALTER TABLE users
    ADD CONSTRAINT FK_USERS_ON_ID_ROLE FOREIGN KEY (id_role) REFERENCES role (id_role);

ALTER TABLE users
    ALTER COLUMN id_role DROP NOT NULL;

ALTER TABLE users
    ADD id_user BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY;

ALTER TABLE users
ALTER
COLUMN last_name TYPE VARCHAR(255) USING (last_name::VARCHAR(255));

ALTER TABLE place
    ADD max_capacity INTEGER;